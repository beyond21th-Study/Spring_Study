 ## 3.5 템플릿과 콜백
 - 템플릿 : **변하지 않는 전체 구조나 흐름(공통 코드)**을 정의하는 부분. 즉, “이건 항상 이렇게 돌아간다”라는 고정된 틀을 잡는 역할. 예를 들어, try/catch, 자원 닫기, 예외 처리 같은 반복되는 부분을 템플릿이 담당.

 - 콜백 : **변하는 부분(구체적인 동작)**을 외부에서 주입받아 실행하는 함수나 객체. 즉, “상황에 따라 다르게 해야 하는 코드”를 템플릿이 대신 호출해주는 구조.
-  -> 얘네 왜 쓰는데? -> 복되는 코드(템플릿)는 재사용하고, 바뀌는 부분(콜백)은 자유롭게 바꾸기 위해.

 - <동작원리>
  - : 템플릿이 “전체 흐름”을 잡고, 콜백이 “특정 시점에 실행될 구체적인 동작”을 전달받아 실행한다.
   - 1. 개발자가 템플릿에게 콜백을 전달 -> “이때 이 동작을 해줘!” 라고 요청
   - 2. 템플릿이 내부에서 정해진 순서로 흐름을 실행
       - 공통 로직 수행 (자원 연결, 예외 처리 등)
       - 필요한 시점에 콜백 호출 (callback.doSomething())
       - 자원 정리, 종료 등 마무리 처리
   - 3. 결과를 반환하거나 로그를 남김

- <콜백의 재활용>
  - 한 번 정의된 콜백은 다양한 템플릿 실행에 재활용 가능
    - 공통 로직을 한 번만 정의
    - 여러 템플릿 실행에 재사용 가능
    - 테스트, 유지보수, 확장 용이
   
- <콜백의 분리와 재활용>
  - 콜백은 템플릿 안에 감춰두지 말고, 외부 클래스로 분리
    - 템플릿은 **흐름 제어(공통 구조)**만 담당
    - 콜백은 구체적 실행 로직만 담당
    - -> 템플릿과 콜백의 결합도가 낮아지고, 재사용성↑, 확장성↑
      
- <콜백과 템플릿의 결합>
  - 템플릿이 실행 흐름 중 특정 시점에서 콜백을 “호출(callback)”한다
    - 사용자 → 템플릿 실행 요청→ 템플릿 내부에서 콜백 호출 → 콜백이 특정 동작 수행 → 템플릿이 흐름 마무리
   
- <템플릿/콜백의 응용>
  - 템플릿은 “흐름”을 고정하고, 콜백만 교체해서 다양한 작업 수행 가능.

- <중복의 제거와 템플릿/콜백 설계>
  - try/catch, 자원 정리, 반복 흐름이 매번 중복되는게 문제.
     - 템플릿이 그 중복된 흐름을 하나의 공통 구조로 캡슐화.
     - 콜백이 “변하는 부분”만 담당.
     - -> 코드 중복 제거
     - -> 유지보수 시 한 곳만 수정하면 전체 흐름 변경 가능
  - 좋은 콜백의 설계
     - 작고 명확한 역할 — 한 가지 일만 한다.
     - 상태에 의존하지 않는다 — 외부 상태에 덜 의존해야 재사용 가능.
     - 템플릿과 느슨하게 결합된다 — 템플릿 내부 구조에 종속되지 않는다.
     - 인터페이스 기반 설계 — 인터페이스로 정의해 다양한 구현체 가능.
      
- <템플릿/콜백의 재설계>
- <img width="802" height="437" alt="image" src="https://github.com/user-attachments/assets/d4d814d9-826a-4c10-83bf-182fe0e62070" />

## 스프링의 JdbcTemplate

- <update()>
  - 데이터 변경(INSERT, UPDATE, DELETE) SQL 실행용 메서드
  - 동작원리
    - 템플릿이 Connection, PreparedStatement 생성 -> SQL 실행 (콜백 내부에서) -> 영향을 받은 행(row) 개수 반환
- <queryForInt()>
  - 과거 메서드, 지금은 queryForObject로 대체됨)
  - 단일 정수값(카운트 등)을 반환할 때 사용
  - 동작원리
     - 템플릿이 SQL 실행 -> 결과셋의 첫 번째 컬럼 값을 정수형으로 반환 -> 내부적으로 ResultSetExtractor 콜백 사용
- <queryForObject()>
   - 단일 객체 한 개 반환 (1 row, 1 object)
   - 동작원리
      - 템플릿이 SQL 실행 -> 결과셋의 첫 번째 컬럼 값을 정수형으로 반환 -> 내부적으로 ResultSetExtractor 콜백 사용
      - 결과가 0개면 EmptyResultDataAccessException 발생,
      - 2개 이상이면 IncorrectResultSizeDataAccessException 발생
- <query()>
  - 여러 행을 조회할 때 사용
  - 동작원리
     - 템플릿이 SQL 실행 -> 결과셋을 한 줄씩 RowMapper 콜백에 전달 -> 매핑된 객체들을 리스트로 반환




